<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日野森志歩</title>
    <script>
        const popupCount = 10;
        const imageCount = 66;
        const focusInterval = 50; // フォーカスを戻す間隔（ミリ秒）

        function getRandomPosition(max) {
            return Math.floor(Math.random() * max);
        }

        function getRandomImage() {
            const imageNumber = String(Math.floor(Math.random() * imageCount) + 1).padStart(3, '0');
            return `images/image${imageNumber}.jpg`;
        }

        function createPopup() {
            let popupWindows = [];
            for (let i = 0; i < popupCount; i++) {
                const imageUrl = getRandomImage();
                const img = new Image();
                img.onload = function() {
                    const width = Math.min(img.width, window.screen.width * 0.8);
                    const height = Math.min(img.height, window.screen.height * 0.8);
                    const left = getRandomPosition(window.screen.width - width);
                    const top = getRandomPosition(window.screen.height - height);
                    const popupWindow = window.open("", "popupWindow" + i, `width=${width},height=${height},left=${left},top=${top}`);
                    if (popupWindow) {
                        popupWindows.push(popupWindow);
                        popupWindow.document.write(`
                            <html lang="ja">
                            <head>
                                <meta charset="UTF-8">
                                <title>日野森志歩</title>
                                <style>
                                    body { margin: 0; display: flex; align-items: center; justify-content: center; height: 100%; }
                                    img { max-width: 100%; height: auto; }
                                </style>
                            </head>
                            <body>
                                <img src="${imageUrl}" alt="ランダム画像">
                            </body>
                            </html>
                        `);
                        popupWindow.onunload = function() {
                            setTimeout(createPopup, 200);
                        };
                    } else {
                        alert("ポップアップウィンドウを開けませんでした。ポップアップブロッカーを無効にしてください。");
                    }
                };
                img.onerror = function() {
                    console.error(`画像の読み込みに失敗しました: ${imageUrl}`);
                };
                img.src = imageUrl;
            }

            // ポップアップウィンドウを常に最前面に維持する
            setInterval(() => {
                popupWindows.forEach(popup => {
                    if (!popup.closed) {
                        popup.focus();
                    }
                });
            }, focusInterval);

            // 元のウィンドウが閉じられたかをチェックし、新しいポップアップを生成し続ける
            const checkOriginalWindowClosed = setInterval(() => {
                if (window.opener == null || window.opener.closed) {
                    clearInterval(checkOriginalWindowClosed);
                    createPopup();
                }
            }, 1000);
        }

        document.addEventListener('DOMContentLoaded', () => {
            createPopup();
        });
    </script>
</head>
<body>
</body>
</html>
